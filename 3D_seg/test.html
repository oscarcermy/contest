<!DOCTYPE html>
    <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Three.js OffscreenCanvas Render</title>
            <style>
                /* 隐藏 canvas 元素 */
                #hiddenCanvas {
                    display: none;
                }
            </style>
        </head>
        <body>
            <canvas id="hiddenCanvas"></canvas>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r140/three.min.js"></script>
            <script>
                // 获取隐藏的 canvas 元素
                const hiddenCanvas = document.getElementById('hiddenCanvas');
                const width = 800;
                const height = 600;

                // 创建 OffscreenCanvas
                const offscreenCanvas = hiddenCanvas.transferControlToOffscreen();

                // 创建 WebGLRenderer
                const renderer = new THREE.WebGLRenderer({ canvas: offscreenCanvas });
                renderer.setSize(width, height);

                // 创建场景
                const scene = new THREE.Scene();

                // 创建相机
                const camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
                camera.position.set(0, 0, 5);

                // 添加光源
                const ambientLight = new THREE.AmbientLight(0x404040);
                scene.add(ambientLight);

                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
                directionalLight.position.set(1, 1, 1);
                scene.add(directionalLight);

                // 加载 GLB 文件
                const loader = new THREE.GLTFLoader();
                loader.load('path/to/your/model.glb', (gltf) => {
                    const model = gltf.scene;
                    scene.add(model);

                    // 加载贴图文件
                    const textureLoader = new THREE.TextureLoader();
                    textureLoader.load('path/to/your/texture.jpg', (texture) => {
                        model.traverse((child) => {
                            if (child.isMesh) {
                                child.material.map = texture;
                                child.material.needsUpdate = true;
                            }
                        });

                        // 渲染场景
                        renderer.render(scene, camera);

                        // 将渲染结果输出到隐藏的 canvas 元素
                        const hiddenCanvasContext = hiddenCanvas.getContext('2d');
                        const imageData = renderer.domElement.getContext('webgl').readPixels(0, 0, width, height, renderer.domElement.getContext('webgl').RGBA, renderer.domElement.getContext('webgl').UNSIGNED_BYTE, new Uint8Array(width * height * 4));
                        const image = new ImageData(new Uint8ClampedArray(imageData), width, height);
                        hiddenCanvasContext.putImageData(image, 0, 0);

                        console.log('Rendering complete. Image data is available in the hidden canvas.');
                    });
                });

                // 设置相机参数
                camera.position.set(0, 0, 5);
                camera.lookAt(scene.position);

                // 渲染场景
                renderer.render(scene, camera);
            </script>
        </body>
    </html>